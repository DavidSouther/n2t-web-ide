{"version":3,"file":"static/js/432.9a108d08.chunk.js","mappings":"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","sources":["shell/editor.tsx","shell/panel.tsx","../../components/src/chips/keyboard.tsx","../../components/src/inline_edit.tsx","../../components/src/virtual_scroll.tsx","../../components/src/chips/memory.tsx","../../components/src/chips/register.tsx","../../components/src/chips/screen.tsx","../../components/src/clockface.tsx","../../components/src/react.ts","../../components/src/runbar.tsx","../../components/src/timer.tsx","../../simulator/src/timer.ts"],"sourcesContent":["import { debounce } from \"@davidsouther/jiffies/lib/esm/debounce\";\nimport { Trans } from \"@lingui/macro\";\nimport MonacoEditor, { useMonaco } from \"@monaco-editor/react\";\nimport type * as monacoT from \"monaco-editor/esm/vs/editor/editor.api\";\nimport { OnMount } from \"@monaco-editor/react\";\nimport ohm from \"ohm-js\";\nimport {\n  CSSProperties,\n  useCallback,\n  useContext,\n  useEffect,\n  useMemo,\n  useRef,\n  useState,\n} from \"react\";\nimport { AppContext } from \"../App.context\";\n\nimport {\n  Span,\n  UNKNOWN_PARSE_ERROR,\n} from \"@nand2tetris/simulator/languages/base.js\";\n\nimport \"./editor.scss\";\n\nexport const ErrorPanel = ({ error }: { error?: ohm.MatchResult }) => {\n  return error?.failed() ? (\n    <details className=\"ErrorPanel\" open>\n      <summary role=\"button\" className=\"secondary\">\n        <Trans>Parse Error</Trans>\n      </summary>\n      <pre>\n        <code>\n          {error?.message ?? error?.shortMessage ?? UNKNOWN_PARSE_ERROR}\n        </code>\n      </pre>\n    </details>\n  ) : (\n    <></>\n  );\n};\n\nconst Textarea = ({\n  value,\n  onChange,\n  language,\n  disabled = false,\n}: {\n  value: string;\n  onChange: (value: string) => void;\n  language: string;\n  disabled?: boolean;\n}) => {\n  const [text, setText] = useState(value);\n  return (\n    <textarea\n      data-testid={`editor-${language}`}\n      disabled={disabled}\n      value={text}\n      onChange={(e) => {\n        const value = e.target?.value;\n        setText(value);\n        onChange(value);\n      }}\n    />\n  );\n};\n\nconst MONACO_LIGHT_THEME = \"vs\";\nconst MONACO_DARK_THEME = \"vs-dark\";\n\nconst makeHighlight = (\n  monaco: typeof monacoT | null,\n  editor: monacoT.editor.IStandaloneCodeEditor | undefined,\n  highlight: Span | undefined,\n  decorations: string[]\n): string[] => {\n  if (!(editor && highlight)) return decorations;\n  const model = editor.getModel();\n  if (!model) return decorations;\n  const start = model.getPositionAt(highlight.start);\n  const end = model.getPositionAt(highlight.end);\n  const range = monaco?.Range.fromPositions(start, end);\n  const nextDecoration: monacoT.editor.IModelDeltaDecoration[] = [];\n  if (range) {\n    nextDecoration.push({\n      range,\n      options: { inlineClassName: \"highlight\" },\n    });\n    editor.revealRangeInCenter(range);\n  }\n  return editor.deltaDecorations(decorations, nextDecoration);\n};\n\nconst Monaco = ({\n  value,\n  onChange,\n  language,\n  error,\n  disabled = false,\n  highlight: currentHighlight,\n}: {\n  value: string;\n  onChange: (value: string) => void;\n  language: string;\n  error?: ohm.MatchResult | undefined;\n  disabled?: boolean;\n  highlight?: Span;\n}) => {\n  const { theme } = useContext(AppContext);\n  const monaco = useMonaco();\n\n  const editor = useRef<monacoT.editor.IStandaloneCodeEditor>();\n  const decorations = useRef<string[]>([]);\n  const highlight = useRef<Span | undefined>(undefined);\n\n  const codeTheme = useCallback(() => {\n    const isDark =\n      theme === \"system\"\n        ? window.matchMedia(\"(prefers-color-scheme: dark)\").matches\n        : theme === \"dark\";\n    return isDark ? MONACO_DARK_THEME : MONACO_LIGHT_THEME;\n  }, [theme]);\n\n  const doHighlight = useCallback(() => {\n    decorations.current = makeHighlight(\n      monaco,\n      editor.current,\n      // I'm not sure why this makes things work, but it is load bearing.\n      // Removing the empty span will cause the initial first-statement\n      // highlight in the test view to not show. Setting it to [0, 1] will\n      // cause a 1-character highlight in the editor view, so don't do that\n      // either.\n      highlight.current ?? { start: 0, end: 0 },\n      decorations.current\n    );\n  }, [decorations, monaco, editor, highlight]);\n\n  // Mark and center highlighted spans\n  useEffect(() => {\n    highlight.current = currentHighlight;\n    doHighlight();\n  }, [currentHighlight]);\n\n  // Set options when mounting\n  const onMount: OnMount = useCallback(\n    (ed) => {\n      editor.current = ed;\n      editor.current?.updateOptions({\n        fontFamily: `\"JetBrains Mono\", source-code-pro, Menlo, Monaco,\n      Consolas, \"Roboto Mono\", \"Ubuntu Monospace\", \"Noto Mono\", \"Oxygen Mono\",\n      \"Liberation Mono\", monospace, \"Apple Color Emoji\", \"Segoe UI Emoji\",\n      \"Segoe UI Symbol\", \"Noto Color Emoji\"`,\n        fontSize: 16,\n        minimap: {\n          enabled: false,\n        },\n        theme: codeTheme(),\n        scrollBeyondLastLine: false,\n        readOnly: disabled,\n      });\n      doHighlight();\n    },\n    [codeTheme]\n  );\n\n  // Set themes\n  useEffect(() => {\n    if (editor.current === undefined) return;\n    editor.current.updateOptions({ theme: codeTheme() });\n  }, [editor, codeTheme]);\n\n  // Prevent editing disabled editors\n  useEffect(() => {\n    if (editor.current === undefined) return;\n    editor.current.updateOptions({ readOnly: disabled });\n  }, [editor, disabled]);\n\n  // Add error markers on parse failure\n  useEffect(() => {\n    if (editor.current === undefined) return;\n    if (monaco === null) return;\n    const model = editor.current.getModel();\n    if (model === null) return;\n    if (error === undefined || error.succeeded()) {\n      monaco.editor.setModelMarkers(model, language, []);\n      return;\n    }\n    // Line 7, col 5:\n    const { line, column, message } =\n      /Line (?<line>\\d+), col (?<column>\\d+): (?<message>.*)/.exec(\n        error.shortMessage ?? \"\"\n      )?.groups ?? { line: 1, column: 1, message: \"could not parse error\" };\n    const startLineNumber = Number(line);\n    const endLineNumber = startLineNumber;\n    const startColumn = Number(column);\n    const restOfLine = model\n      .getLineContent(startLineNumber)\n      .substring(startColumn - 1);\n    let endColumn =\n      startColumn + (restOfLine.match(/([^\\s]+)/)?.[0].length ?? 1);\n    if (endColumn <= startColumn) {\n      endColumn = startColumn + 1;\n    }\n\n    monaco.editor.setModelMarkers(model, language, [\n      {\n        message,\n        startColumn,\n        startLineNumber,\n        endColumn,\n        endLineNumber,\n        severity: 8, // monacoT.MarkerSeverity.Error,\n      },\n    ]);\n  }, [error, editor, monaco, language]);\n\n  return (\n    <>\n      <MonacoEditor\n        value={value}\n        onChange={(v = \"\") => onChange(v)}\n        language={language}\n        onMount={onMount}\n      />\n    </>\n  );\n};\n\nexport const Editor = ({\n  className = \"\",\n  style = {},\n  disabled = false,\n  value,\n  onChange,\n  grammar,\n  language,\n  highlight,\n}: {\n  className?: string;\n  style?: CSSProperties;\n  disabled?: boolean;\n  value: string;\n  onChange: (source: string) => void;\n  grammar: ohm.Grammar;\n  language: string;\n  highlight?: Span;\n}) => {\n  const [error, setError] = useState<ohm.MatchResult>();\n  const { monaco } = useContext(AppContext);\n\n  const parse = useCallback(\n    (text = \"\") => {\n      const parsed = grammar.match(text);\n      setError(parsed.failed() ? parsed : undefined);\n    },\n    [setError, grammar]\n  );\n\n  useEffect(() => parse(value), [parse, value]);\n  const doParse = useMemo(() => debounce(parse, 500), [parse]);\n\n  const onChangeCB = useCallback(\n    (text = \"\") => {\n      onChange(text);\n      doParse(text);\n    },\n    [doParse, onChange]\n  );\n\n  return (\n    <div className={`Editor ${className}`} style={style}>\n      {monaco.canUse && monaco.wants ? (\n        <Monaco\n          value={value}\n          onChange={onChangeCB}\n          language={language}\n          error={error}\n          disabled={disabled}\n          highlight={highlight}\n        />\n      ) : (\n        <>\n          <Textarea\n            value={value}\n            onChange={onChangeCB}\n            language={language}\n            disabled={disabled}\n          />\n          <ErrorPanel error={error} />\n        </>\n      )}\n    </div>\n  );\n};\n","import { CSSProperties, ReactNode } from \"react\";\n\nexport const Panel = (props: {\n  children: ReactNode;\n  header?: ReactNode;\n  footer?: ReactNode;\n  className?: string;\n  style?: CSSProperties;\n}) => {\n  return (\n    <article className={[\"panel\", props.className ?? \"\"].join(\" \")}>\n      {props.header && <header>{props.header}</header>}\n      <main>{props.children}</main>\n      {props.footer && <footer>{props.footer}</footer>}\n    </article>\n  );\n};\n\nexport const Accordian = (props: {\n  children: ReactNode;\n  summary: ReactNode;\n  className?: string;\n  style?: CSSProperties;\n  open?: boolean;\n}) => {\n  return (\n    <details\n      className={props.className ?? \"\"}\n      open={props.open}\n      style={props.style}\n    >\n      <summary>\n        <div className=\"flex row align-baseline\">{props.summary}</div>\n      </summary>\n      {props.children}\n    </details>\n  );\n};\n","import { KeyboardEvent, useState } from \"react\";\nimport { KeyboardAdapter } from \"@nand2tetris/simulator/cpu/memory.js\";\nimport { RegisterComponent } from \"./register.js\";\n\nconst KeyMap: Record<string, number | undefined> = {\n  // Delete: 127,\n  Enter: 128,\n  Backspace: 129,\n  ArrowLeft: 130,\n  ArrowUp: 131,\n  ArrowRight: 132,\n  ArrowDown: 133,\n  Home: 134,\n  End: 135,\n  PageUp: 136,\n  PageDown: 137,\n  Insert: 138,\n  Delete: 139,\n  Escape: 140,\n  F1: 141,\n  F2: 142,\n  F3: 143,\n  F4: 144,\n  F5: 145,\n  F6: 146,\n  F7: 147,\n  F8: 148,\n  F9: 149,\n  F10: 150,\n  F11: 151,\n  F12: 152,\n};\n\nfunction keyPressToHackCharacter(keypress: KeyboardEvent): number {\n  const mapping = KeyMap[keypress.key];\n  if (mapping !== undefined) {\n    return mapping;\n  }\n  if (keypress.key.length === 1) {\n    const code = keypress.key.charCodeAt(0);\n    if (code >= 32 && code <= 126) {\n      return code;\n    }\n  }\n\n  return 0;\n}\n\nexport const Keyboard = ({\n  keyboard,\n  update,\n}: {\n  keyboard: KeyboardAdapter;\n  update?: () => void;\n}) => {\n  const [showPicker, setShowPicker] = useState(false);\n  const [bits, setBits] = useState(keyboard.getKey());\n  let currentKey = 0;\n\n  const onKeyDown = (event: KeyboardEvent<HTMLInputElement>) => {\n    event.preventDefault();\n    const key = keyPressToHackCharacter(event);\n    if (key === currentKey) {\n      return;\n    }\n    setKey(key);\n    update?.();\n  };\n\n  const onKeyUp = (event: KeyboardEvent<HTMLInputElement>) => {\n    currentKey = 0;\n    keyboard.clearKey();\n    update?.();\n    setBits(keyboard.getKey());\n  };\n\n  const setKey = (key: number) => {\n    if (key === 0) {\n      return;\n    }\n    keyboard.setKey(key);\n    setBits(keyboard.getKey());\n    currentKey = key;\n    // setShowPicker(false);\n  };\n\n  const clear = () => {\n    setKey(0);\n  };\n\n  const changeKey = () => {\n    setShowPicker(true);\n  };\n\n  return (\n    <div className=\"flex row align-baseline\">\n      <div className=\"flex-1\">\n        <RegisterComponent name=\"Keyboard\" bits={bits} />\n      </div>\n      <div className={showPicker ? \"flex-1\" : \"flex-0\"}>\n        {showPicker ? (\n          <input\n            ref={(e) => e?.focus()}\n            type=\"text\"\n            onKeyDown={onKeyDown}\n            onKeyUp={onKeyUp}\n          />\n        ) : (\n          <fieldset role=\"group\">\n            <button onClick={changeKey}>\n              {/* <Icon name=\"keyboard\" /> */}\n              ‚å®Ô∏è\n            </button>\n            <button onClick={clear}>üÜë</button>\n          </fieldset>\n        )}\n      </div>\n    </div>\n  );\n};\n","import { width } from \"@davidsouther/jiffies/lib/esm/dom/css/sizing.js\";\nimport { useCallback, useState } from \"react\";\nimport { useStateInitializer } from \"./react.js\";\n\nconst Mode = { VIEW: 0, EDIT: 1 };\n\nexport const InlineEdit = (props: {\n  mode?: keyof typeof Mode;\n  value: string;\n  onChange: (value: string) => void;\n}) => {\n  const [mode, setMode] = useState(props.mode ?? Mode.VIEW);\n  const [value, setValue] = useStateInitializer(props.value);\n\n  const render = () => {\n    switch (mode) {\n      case Mode.EDIT:\n        return edit();\n      case Mode.VIEW:\n        return view();\n      default:\n        return <span />;\n    }\n  };\n\n  const view = () => (\n    <span\n      style={{ cursor: \"text\", ...width(\"full\", \"inline\") }}\n      onClick={() => {\n        setMode(Mode.EDIT);\n      }}\n    >\n      {value}\n    </span>\n  );\n\n  const doSelect = useCallback(\n    (ref: HTMLInputElement | null) => ref?.select(),\n    []\n  );\n  const doChange = useCallback(\n    (target: HTMLInputElement) => {\n      setMode(Mode.VIEW);\n      setValue(target.value ?? \"\");\n      props.onChange(target.value ?? \"\");\n    },\n    [props, setMode, setValue]\n  );\n  const edit = () => {\n    const edit = (\n      <span style={{ display: \"block\", position: \"relative\" }}>\n        <input\n          ref={doSelect}\n          style={{\n            zIndex: \"10\",\n            position: \"absolute\",\n            left: \"0\",\n            marginTop: \"-0.375rem\",\n          }}\n          onBlur={({ target }) => doChange(target)}\n          onKeyPress={({ key, target }) => {\n            if (key === \"Enter\") {\n              doChange(target as HTMLInputElement);\n            }\n          }}\n          type=\"text\"\n          defaultValue={value}\n        />\n      </span>\n    );\n    return edit;\n  };\n\n  return render();\n};\n\nexport default InlineEdit;\n","/* eslint-disable @typescript-eslint/ban-types */\nimport {\n  Key,\n  ReactNode,\n  useCallback,\n  useEffect,\n  useMemo,\n  useReducer,\n  useRef,\n} from \"react\";\n\nexport interface VirtualScrollSettings {\n  /**Minimum offset into the adapter. Default is 0.  */\n  minIndex: number;\n  /** Maximum offset into the adapter. Default is Number.MAX_SAFE_INTEGER.  */\n  maxIndex: number;\n  /** Initial index to start rendering from. Default is minIndex.  */\n  startIndex: number;\n  /**\n   * Number of items to render in visible area. Default is entire range from\n   * minIndex to maxIndex.\n   */\n  count: number;\n  /**\n   * Maximum number of items to render on either side of the visible area.\n   * Default is `count`.\n   */\n  tolerance: number;\n  /** Height of each item, in pixels. Default is 20px. */\n  itemHeight: number;\n}\n\nexport interface VirtualScrollDataAdapter<T> {\n  (offset: number, limit: number): Iterable<T>;\n}\n\nexport function arrayAdapter<T>(data: T[]): VirtualScrollDataAdapter<T> {\n  return (offset, limit) => data.slice(offset, offset + limit);\n}\n\nexport interface VirtualScrollProps<T, U extends ReactNode> {\n  settings?: Partial<VirtualScrollSettings>;\n  get: VirtualScrollDataAdapter<T>;\n  row: (t: T) => U;\n  rowKey: (t: T) => Key;\n}\n\nexport function fillVirtualScrollSettings(\n  settings: Partial<VirtualScrollSettings>\n): VirtualScrollSettings {\n  const {\n    minIndex = 0,\n    maxIndex = Number.MAX_SAFE_INTEGER,\n    startIndex = 0,\n    itemHeight = 20,\n    count = Math.max(maxIndex - minIndex, 1),\n    tolerance = count,\n  } = settings;\n\n  return { minIndex, maxIndex, startIndex, itemHeight, count, tolerance };\n}\n\nexport function initialState<T>(\n  settings: VirtualScrollSettings,\n  adapter: VirtualScrollDataAdapter<T>\n): VirtualScrollState<T> {\n  // From Denis Hilt, https://blog.logrocket.com/virtual-scrolling-core-principles-and-basic-implementation-in-react/\n  const { minIndex, maxIndex, startIndex, itemHeight, count, tolerance } =\n    settings;\n  const bufferedItems = count + 2 * tolerance;\n  const itemsAbove = Math.max(0, startIndex - tolerance - minIndex);\n\n  const viewportHeight = count * itemHeight;\n  const totalHeight = Math.max(maxIndex - minIndex, 1) * itemHeight;\n  const toleranceHeight = tolerance * itemHeight;\n  const bufferHeight = viewportHeight + 2 * toleranceHeight;\n  const topPaddingHeight = itemsAbove * itemHeight;\n  const bottomPaddingHeight = totalHeight - (topPaddingHeight + bufferHeight);\n\n  const state: VirtualScrollState<T> = {\n    scrollTop: 0,\n    settings,\n    viewportHeight,\n    totalHeight,\n    toleranceHeight,\n    bufferedItems,\n    topPaddingHeight,\n    bottomPaddingHeight,\n    data: [],\n  };\n\n  return {\n    ...state,\n    ...doScroll(topPaddingHeight + toleranceHeight, state, adapter),\n  };\n}\n\nexport function getData<T>(\n  minIndex: number,\n  maxIndex: number,\n  offset: number,\n  limit: number,\n  get: VirtualScrollDataAdapter<T>\n): T[] {\n  const start = Math.max(0, minIndex, offset);\n  const end = Math.min(maxIndex, offset + limit - 1);\n  const data = get(start, end - start);\n  return [...data];\n}\n\ninterface ScrollUpdate<T> {\n  scrollTop: number;\n  topPaddingHeight: number;\n  bottomPaddingHeight: number;\n  data: T[];\n}\n\nexport function doScroll<T>(\n  scrollTop: number,\n  state: VirtualScrollState<T>,\n  get: VirtualScrollDataAdapter<T>\n): ScrollUpdate<T> {\n  const {\n    totalHeight,\n    toleranceHeight,\n    bufferedItems,\n    settings: { itemHeight, minIndex, maxIndex },\n  } = state;\n  const index =\n    minIndex + Math.floor((scrollTop - toleranceHeight) / itemHeight);\n  const data = getData(minIndex, maxIndex, index, bufferedItems, get);\n  const topPaddingHeight = Math.max((index - minIndex) * itemHeight, 0);\n  const bottomPaddingHeight = Math.max(\n    totalHeight - (topPaddingHeight + data.length * itemHeight),\n    0\n  );\n\n  return { scrollTop, topPaddingHeight, bottomPaddingHeight, data };\n}\n\ninterface VirtualScrollState<T> {\n  settings: VirtualScrollSettings;\n  scrollTop: number; // px\n  bufferedItems: number; // count\n  totalHeight: number; // px\n  viewportHeight: number; // px\n  topPaddingHeight: number; // px\n  bottomPaddingHeight: number; // px\n  toleranceHeight: number; // px\n  data: T[];\n}\n\nconst scrollReducer =\n  <T extends {}>(get: VirtualScrollDataAdapter<T>) =>\n  (state: VirtualScrollState<T>, scrollTop: number) => ({\n    ...state,\n    ...doScroll(scrollTop, state, get),\n  });\n\nexport const VirtualScroll = <T extends {}, U extends ReactNode = ReactNode>(\n  props: VirtualScrollProps<T, U> & { className?: string }\n) => {\n  const viewportRef = useRef<HTMLDivElement | null>(null);\n\n  const { settings, startState, reducer } = useMemo(() => {\n    const settings = fillVirtualScrollSettings(props.settings ?? {});\n    const startState = initialState<T>(settings, props.get);\n    const reducer = scrollReducer(props.get);\n    return { settings, reducer, startState };\n  }, [props.settings, props.get]);\n\n  const [state, dispatchScroll] = useReducer(reducer, startState);\n\n  useEffect(() => {\n    if (viewportRef.current !== null) {\n      dispatchScroll(viewportRef.current.scrollTop);\n    }\n  }, [settings, props.row]);\n\n  const initialScroll = useCallback(\n    (div: HTMLDivElement | null) => {\n      if (div) {\n        div.scrollTop = viewportRef.current\n          ? viewportRef.current.scrollTop\n          : settings.startIndex * settings.itemHeight;\n      }\n      viewportRef.current = div;\n    },\n    [viewportRef, settings.startIndex, settings.itemHeight]\n  );\n\n  const rows = state.data.map((d) => (\n    <div key={props.rowKey(d)} style={{ height: `${settings.itemHeight}px` }}>\n      {props.row(d)}\n    </div>\n  ));\n\n  return (\n    <div\n      ref={initialScroll}\n      style={{\n        height: `${state.viewportHeight}px`,\n        overflowY: \"scroll\",\n        overflowAnchor: \"none\",\n      }}\n      className={props.className ?? \"\"}\n      onScroll={(e) => dispatchScroll((e.target as HTMLDivElement).scrollTop)}\n    >\n      <div style={{ height: `${state.topPaddingHeight}px` }} />\n      {rows}\n      <div style={{ height: `${state.bottomPaddingHeight}px` }} />\n    </div>\n  );\n};\n\nexport default VirtualScroll;\n","import { rounded } from \"@davidsouther/jiffies/lib/esm/dom/css/border.js\";\nimport {\n  ChangeEvent,\n  ReactNode,\n  useCallback,\n  useContext,\n  useMemo,\n  useRef,\n  useState,\n} from \"react\";\n\nimport {\n  Format,\n  FORMATS,\n  MemoryAdapter,\n} from \"@nand2tetris/simulator/cpu/memory.js\";\nimport { asm } from \"@nand2tetris/simulator/util/asm.js\";\nimport { bin, dec, hex } from \"@nand2tetris/simulator/util/twos.js\";\nimport { loadBlob, loadAsm, loadHack } from \"@nand2tetris/simulator/loader.js\";\n\nimport InlineEdit from \"../inline_edit.js\";\nimport VirtualScroll, { VirtualScrollSettings } from \"../virtual_scroll.js\";\nimport { useClockReset } from \"../clockface.js\";\nimport { BaseContext } from \"../stores/base.context.js\";\n\nconst ITEM_HEIGHT = 34;\n\nexport const MemoryBlock = ({\n  memory,\n  jmp = { value: 0 },\n  highlight = -1,\n  editable = false,\n  format = dec,\n  onChange = () => undefined,\n}: {\n  jmp?: { value: number };\n  memory: MemoryAdapter;\n  highlight?: number;\n  editable?: boolean;\n  format?: (v: number) => string;\n  onChange?: (i: number, value: string, previous: number) => void;\n}) => {\n  const settings = useMemo<Partial<VirtualScrollSettings>>(\n    () => ({\n      count: Math.min(memory.size, 25),\n      maxIndex: memory.size,\n      itemHeight: ITEM_HEIGHT,\n      startIndex: jmp.value,\n    }),\n    [memory.size, jmp]\n  );\n  const get = useCallback(\n    (offset: number, count: number) =>\n      memory\n        .range(offset, offset + count)\n        .map((v, i) => [i + offset, v] as [number, number]),\n    [memory]\n  );\n  const row = useCallback(\n    ([i, v]: [number, number]) => (\n      <MemoryCell\n        index={i}\n        value={format(v)}\n        editable={editable}\n        highlight={i === highlight}\n        onChange={onChange}\n      />\n    ),\n    [format, editable, highlight, onChange]\n  );\n\n  return (\n    <VirtualScroll<[number, number], ReactNode>\n      settings={settings}\n      get={get}\n      row={row}\n      rowKey={([i]) => i}\n    />\n  );\n};\n\nexport const MemoryCell = ({\n  index,\n  value,\n  highlight = false,\n  editable = false,\n  onChange = () => undefined,\n}: {\n  index: number;\n  value: string;\n  highlight?: boolean;\n  editable?: boolean;\n  onChange?: (i: number, value: string, previous: number) => void;\n}) => (\n  <div style={{ display: \"flex\", height: \"100%\" }}>\n    <code\n      style={{\n        ...rounded(\"none\"),\n        ...(highlight ? { background: \"var(--mark-background-color)\" } : {}),\n      }}\n    >\n      {hex(index)}\n    </code>\n    <code\n      style={{\n        flex: \"1\",\n        textAlign: \"right\",\n        ...rounded(\"none\"),\n        ...(highlight ? { background: \"var(--mark-background-color)\" } : {}),\n      }}\n    >\n      {editable ? (\n        <InlineEdit\n          value={value}\n          onChange={(newValue: string) =>\n            onChange(index, newValue, Number(value))\n          }\n        />\n      ) : (\n        <span>{value}</span>\n      )}\n    </code>\n  </div>\n);\n\nexport const Memory = ({\n  name = \"Memory\",\n  highlight = -1,\n  editable = true,\n  memory,\n  format = \"dec\",\n}: {\n  name?: string;\n  editable?: boolean;\n  highlight?: number;\n  memory: MemoryAdapter;\n  format: Format;\n}) => {\n  const [fmt, setFormat] = useState(format);\n  const [jmp, setJmp] = useState(\"\");\n  const [goto, setGoto] = useState({ value: 0 });\n\n  const jumpTo = () => {\n    setGoto({\n      value: !isNaN(parseInt(jmp)) && isFinite(parseInt(jmp)) ? Number(jmp) : 0,\n    });\n  };\n\n  const fileUploadRef = useRef<HTMLInputElement>(null);\n  const doLoad = useCallback(() => {\n    fileUploadRef.current?.click();\n  }, [fileUploadRef]);\n\n  const { setStatus } = useContext(BaseContext);\n  const upload = useCallback(async (event: ChangeEvent<HTMLInputElement>) => {\n    if (!event.target.files?.length) {\n      setStatus(\"No file selected\");\n      return;\n    }\n    const file = event.target.files[0];\n    const source = await file.text();\n    const loader = file.name.endsWith(\"hack\")\n      ? loadHack\n      : file.name.endsWith(\"asm\")\n      ? loadAsm\n      : loadBlob;\n    const bytes = await loader(source);\n    memory.loadBytes(bytes);\n    event.target.value = \"\"; // Clear the input out\n    jumpTo();\n  }, []);\n\n  const doUpdate = useCallback(\n    (i: number, v: string) => {\n      memory.update(i, v, fmt ?? \"dec\");\n    },\n    [memory, fmt]\n  );\n\n  useClockReset(() => {\n    setJmp(\"\");\n    setGoto({ value: 0 });\n  });\n\n  return (\n    <article className={`panel memory ${name}`}>\n      <header>\n        <div>{name}</div>\n        <fieldset role=\"group\">\n          <input\n            type=\"file\"\n            style={{ display: \"none\" }}\n            ref={fileUploadRef}\n            onChange={upload}\n          />\n          <button onClick={doLoad} className=\"flex-0\">\n            {/* <Icon name=\"upload_file\" /> */}\n            üìÇ\n          </button>\n          <input\n            style={{ width: \"4em\", height: \"100%\" }}\n            placeholder=\"Jump\"\n            value={jmp}\n            onKeyDown={({ key }) => key === \"Enter\" && jumpTo()}\n            onChange={({ target: { value } }) => setJmp(value)}\n          />\n          <button onClick={jumpTo} className=\"flex-0\">\n            {/* <Icon name=\"move_down\" /> */}\n            ‚§µÔ∏è\n          </button>\n          <select value={fmt} onChange={(e) => setFormat(e.target.value)}>\n            {FORMATS.map((option) => (\n              <option key={option}>{option}</option>\n            ))}\n          </select>\n        </fieldset>\n      </header>\n      <MemoryBlock\n        jmp={goto}\n        memory={memory}\n        highlight={highlight}\n        editable={editable}\n        format={(v: number) => doFormat(fmt, v)}\n        onChange={doUpdate}\n      />\n    </article>\n  );\n};\n\nexport default Memory;\n\nfunction doFormat(format: Format, v: number): string {\n  switch (format) {\n    case \"bin\":\n      return bin(v);\n    case \"hex\":\n      return hex(v);\n    case \"asm\":\n      return asm(v);\n    case \"dec\":\n    default:\n      return dec(v);\n  }\n}\n","import { dec } from \"@nand2tetris/simulator/util/twos.js\";\n\nexport const RegisterComponent = ({\n  name,\n  bits,\n}: {\n  name: string;\n  bits: number;\n}) => (\n  <div>\n    {name}: {dec(bits)}\n  </div>\n);\n","import { Memory } from \"@nand2tetris/simulator/cpu/memory.js\";\nimport { assertExists } from \"@davidsouther/jiffies/lib/esm/assert.js\";\nimport { useCallback, useRef } from \"react\";\nimport { useClockFrame, useClockReset } from \"../clockface.js\";\n\nconst WHITE = \"white\";\nconst BLACK = \"black\";\ntype COLOR = typeof WHITE | typeof BLACK;\n\nexport interface ScreenMemory {\n  get(idx: number): number;\n}\n\nexport function reduceScreen(memory: Memory, offset = 0): ScreenMemory {\n  return {\n    get(idx: number): number {\n      return memory.get(offset + idx);\n    },\n  };\n}\n\nfunction get(mem: ScreenMemory, x: number, y: number): COLOR {\n  const byte = mem.get(32 * y + ((x / 16) | 0));\n  const bit = byte & (1 << x % 16);\n  return bit === 0 ? WHITE : BLACK;\n}\n\nfunction set(data: Uint8ClampedArray, x: number, y: number, value: COLOR) {\n  const pixel = (y * 512 + x) * 4;\n  const color = value === WHITE ? 255 : 0;\n  data[pixel] = color;\n  data[pixel + 1] = color;\n  data[pixel + 2] = color;\n  data[pixel + 3] = 255;\n}\n\nfunction drawImage(ctx: CanvasRenderingContext2D, memory: ScreenMemory) {\n  const image = assertExists(\n    ctx.getImageData(0, 0, 512, 256),\n    \"Failed to create Context2d\"\n  );\n  for (let col = 0; col < 512; col++) {\n    for (let row = 0; row < 256; row++) {\n      const color = get(memory, col, row);\n      set(image.data, col, row, color);\n    }\n  }\n  ctx.putImageData(image, 0, 0);\n}\n\nexport const Screen = ({ memory }: { memory: ScreenMemory }) => {\n  const canvas = useRef<HTMLCanvasElement>();\n\n  const draw = useCallback(() => {\n    const ctx = canvas.current?.getContext(\"2d\") ?? undefined;\n\n    if (ctx) {\n      drawImage(ctx, memory);\n    }\n  }, [memory]);\n\n  const ctxRef = useCallback(\n    (ref: HTMLCanvasElement | null) => {\n      canvas.current = ref ?? undefined;\n      draw();\n    },\n    [canvas, draw]\n  );\n\n  useClockFrame(draw);\n  useClockReset(() => {\n    canvas.current\n      ?.getContext(\"2d\")\n      ?.clearRect(0, 0, canvas.current.width, canvas.current.height);\n  });\n\n  return (\n    <article className=\"panel\">\n      <header>Screen</header>\n      <main style={{ backgroundColor: \"var(--code-background-color)\" }}>\n        <figure\n          style={{\n            width: \"100%\",\n            maxWidth: \"512px\",\n            boxSizing: \"content-box\",\n            marginInline: \"auto\",\n            margin: \"auto\",\n            borderTop: \"2px solid gray\",\n            borderLeft: \"2px solid gray\",\n            borderBottom: \"2px solid lightgray\",\n            borderRight: \"2px solid lightgray\",\n          }}\n        >\n          <canvas ref={ctxRef} width={512} height={256}></canvas>\n        </figure>\n      </main>\n    </article>\n  );\n};\n","import { useEffect, useMemo, useState } from \"react\";\n\nimport { display } from \"@davidsouther/jiffies/lib/esm/display.js\";\nimport { Clock } from \"@nand2tetris/simulator/chip/clock.js\";\n\nexport function useClock(actions: {\n  tick?: () => void;\n  toggle?: () => void;\n  reset?: () => void;\n}) {\n  const clock = useMemo(() => Clock.get(), []);\n\n  useEffect(() => {\n    const subscription = clock.$.subscribe(() => {\n      actions.tick?.();\n    });\n    return () => subscription.unsubscribe();\n  }, [actions, clock.$]);\n\n  return {\n    toggle() {\n      clock.tick();\n      actions.toggle?.();\n    },\n\n    reset() {\n      clock.reset();\n      actions.reset?.();\n    },\n  };\n}\n\nexport function useClockFrame(frameFinished: () => void) {\n  useEffect(() => {\n    const subscription = Clock.get().frame$.subscribe(() => {\n      frameFinished();\n    });\n    return () => subscription.unsubscribe();\n  }, [frameFinished]);\n}\n\nexport function useClockReset(reset: () => void) {\n  useEffect(() => {\n    const subscription = Clock.get().reset$.subscribe(() => {\n      reset();\n    });\n    return () => subscription.unsubscribe();\n  }, [reset]);\n}\n\nexport function displayClock() {\n  return display(Clock.get());\n}\n\nexport function useClockface() {\n  const [clockface, setClockface] = useState(displayClock());\n\n  useEffect(() => {\n    const subscription = Clock.get().$.subscribe(() => {\n      setClockface(displayClock());\n    });\n    return () => subscription.unsubscribe();\n  }, []);\n\n  return clockface;\n}\n\nexport const Clockface = () => {\n  const clockface = useClockface();\n  return <span style={{ whiteSpace: \"nowrap\" }}>{clockface}</span>;\n};\n","import produce from \"immer\";\nimport { Dispatch, useEffect, useReducer, useState } from \"react\";\n\nexport function useImmerReducer<\n  T,\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  Reducers extends Record<string, (state: T, action?: any) => T | void>\n>(reducers: Reducers, initialState: T) {\n  return useReducer(\n    (\n      state: T,\n      command: {\n        action: keyof Reducers;\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        payload?: any;\n      }\n    ): T =>\n      produce(state, (draft: T) => {\n        reducers[command.action](draft, command.payload);\n      }),\n    initialState\n  );\n}\n\nexport function useStateInitializer<T>(init: T): [T, Dispatch<T>] {\n  const [state, setState] = useState<T>(init);\n  useEffect(() => {\n    setState(init);\n  }, [init]);\n  return [state, setState];\n}\n","import { ReactNode } from \"react\";\nimport { Timer } from \"@nand2tetris/simulator/timer.js\";\nimport { useTimer } from \"./timer.js\";\n\nexport const Runbar = (props: { runner: Timer; children?: ReactNode }) => {\n  const runner = useTimer(props.runner);\n  return (\n    <fieldset role=\"group\">\n      <button\n        className=\"flex-0\"\n        onClick={() => runner.actions.frame()}\n        data-tooltip={`Step`}\n        data-placement=\"bottom\"\n      >\n        {/* <Icon name=\"play_arrow\" /> */}\n        ‚û°Ô∏è\n      </button>\n      <button\n        className=\"flex-0\"\n        onClick={() =>\n          runner.state.running ? runner.actions.stop() : runner.actions.start()\n        }\n        data-tooltip={runner.state.running ? `Pause` : `Play`}\n        data-placement=\"bottom\"\n      >\n        {/* <Icon name={runner.state.running ? \"pause\" : \"fast_forward\"} /> */}\n        {runner.state.running ? \"‚è∏\" : \"Ô∏è‚è©\"}\n      </button>\n      <button\n        className=\"flex-0\"\n        onClick={() => runner.actions.reset()}\n        data-tooltip={`Reset`}\n        data-placement=\"bottom\"\n      >\n        {/* <Icon name=\"fast_rewind\" /> */}‚èÆ\n      </button>\n      <select\n        className=\"flex-1\"\n        name=\"speed\"\n        value={runner.state.speed}\n        onChange={(e) => {\n          runner.dispatch({\n            action: \"setSpeed\",\n            payload: Number(e.target?.value ?? runner.state.speed),\n          });\n        }}\n        disabled={runner.state.running}\n      >\n        {[\n          // [2000, `Debug`], // For debugging, basically the same as clicking through\n          [1000, `Slow`],\n          [500, `Fast`],\n          [16, `Faster`], // 16ms, or 60fps\n        ].map(([speed, label]) => (\n          <option key={speed} value={speed}>\n            {label}\n          </option>\n        ))}\n      </select>\n      <select\n        className=\"flex-1\"\n        name=\"steps\"\n        value={runner.state.steps}\n        onChange={(e) => {\n          runner.dispatch({\n            action: \"setSteps\",\n            payload: Number(e.target?.value ?? runner.state.steps),\n          });\n        }}\n        disabled={runner.state.running}\n      >\n        {[\n          ...[\n            [1, `1 Step`],\n            [500, \"500\"],\n            [1000, \"1000\"],\n            [2000, \"2000\"],\n            [8000, \"8000\"],\n          ],\n          ...(runner.state.speed === 16\n            ? [\n                // 60fps\n                [16666, \"1MHz\"],\n                [16666 * 30, \"30MHz\"],\n              ]\n            : []),\n        ].map(([steps, label]) => (\n          <option key={steps} value={steps}>\n            {label}\n          </option>\n        ))}\n      </select>\n      {props.children}\n    </fieldset>\n  );\n};\n","import { Timer } from \"@nand2tetris/simulator/timer.js\";\nimport { useImmerReducer } from \"./react.js\";\n\nexport interface TimerStoreState {\n  steps: number;\n  speed: number;\n  running: boolean;\n}\n\nimport { Dispatch, MutableRefObject, useMemo, useRef } from \"react\";\nexport type TimerStoreDispatch = Dispatch<{\n  action: keyof ReturnType<typeof makeTimerStore>[\"reducers\"];\n  payload?: unknown;\n}>;\n\nconst makeTimerStore = (\n  timer: Timer,\n  dispatch: MutableRefObject<TimerStoreDispatch>\n) => {\n  const initialState: TimerStoreState = {\n    running: timer.running,\n    speed: timer.speed,\n    steps: timer.steps,\n  };\n\n  const finishFrame = timer.finishFrame.bind(timer);\n  timer.finishFrame = function () {\n    finishFrame();\n    dispatch.current({ action: \"update\" });\n  };\n\n  const reducers = {\n    update(state: TimerStoreState) {\n      state.running = timer.running;\n      state.speed = timer.speed;\n      state.steps = timer.steps;\n    },\n    setSteps(state: TimerStoreState, steps: number) {\n      state.steps = steps;\n      timer.steps = steps;\n    },\n    setSpeed(state: TimerStoreState, speed: number) {\n      state.speed = speed;\n      timer.speed = speed;\n    },\n  };\n\n  const actions = {\n    frame() {\n      timer.frame();\n    },\n    start() {\n      timer.start();\n      dispatch.current({ action: \"update\" });\n    },\n    stop() {\n      timer.stop();\n      dispatch.current({ action: \"update\" });\n    },\n    reset() {\n      timer.reset();\n      dispatch.current({ action: \"update\" });\n    },\n  };\n\n  return { initialState, reducers, actions };\n};\n\nexport function useTimer(timer: Timer) {\n  const dispatch = useRef<TimerStoreDispatch>(() => undefined);\n\n  const { initialState, reducers, actions } = useMemo(\n    () => makeTimerStore(timer, dispatch),\n    [timer, dispatch]\n  );\n\n  const [state, dispatcher] = useImmerReducer(reducers, initialState);\n\n  dispatch.current = dispatcher;\n\n  return { state, dispatch: dispatch.current, actions };\n}\n","import { Clock } from \"./chip/clock.js\";\n\nexport const MAX_STEPS = 1000;\n\nconst clock = Clock.get();\n\nexport abstract class Timer {\n  frame() {\n    this.tick();\n    this.finishFrame();\n  }\n\n  /// Update the simulation state, but DO NOT perform any UI changes.\n  abstract tick(): boolean;\n\n  /// UI Updates are allowed in finishFrame.\n  finishFrame() {\n    clock.frame();\n  }\n\n  abstract reset(): void;\n\n  abstract toggle(): void;\n\n  steps = 1; // How many steps to take per update\n  speed = 1000; // how often to update, in ms\n  get running() {\n    return this.#running;\n  }\n\n  #running = false;\n  #sinceLastFrame = 0;\n  #lastUpdate = 0;\n  #run = async () => {\n    if (!this.#running) {\n      return;\n    }\n    const now = Date.now();\n    const delta = now - this.#lastUpdate;\n    this.#lastUpdate = now;\n    this.#sinceLastFrame += delta;\n    if (this.#sinceLastFrame > this.speed) {\n      let done = false;\n      // let steps = Math.min(this.steps, MAX_STEPS);\n      let steps = this.steps;\n      const timingLabel = `Timing ${steps} steps`;\n      console.time(timingLabel);\n      while (!done && steps--) {\n        // done = await this.tick();\n        done = this.tick();\n      }\n      console.timeEnd(timingLabel);\n      this.finishFrame();\n      if (done) {\n        this.stop();\n      }\n      this.#sinceLastFrame -= this.speed;\n    }\n    requestAnimationFrame(this.#run);\n  };\n\n  start() {\n    this.#running = true;\n    this.#lastUpdate = Date.now() - this.speed;\n    this.#run();\n    this.toggle();\n  }\n\n  stop() {\n    this.#running = false;\n    this.toggle();\n  }\n}\n"],"names":["ErrorPanel","error","failed","className","open","role","message","shortMessage","UNKNOWN_PARSE_ERROR","Textarea","value","onChange","language","disabled","useState","text","setText","e","target","Monaco","currentHighlight","highlight","theme","useContext","AppContext","monaco","useMonaco","editor","useRef","decorations","undefined","codeTheme","useCallback","window","matchMedia","matches","doHighlight","current","model","getModel","start","getPositionAt","end","range","Range","fromPositions","nextDecoration","push","options","inlineClassName","revealRangeInCenter","deltaDecorations","makeHighlight","useEffect","onMount","ed","updateOptions","fontFamily","fontSize","minimap","enabled","scrollBeyondLastLine","readOnly","succeeded","setModelMarkers","exec","groups","line","column","startLineNumber","Number","endLineNumber","startColumn","endColumn","getLineContent","substring","match","length","severity","v","Editor","style","grammar","setError","parse","parsed","doParse","useMemo","debounce","onChangeCB","canUse","wants","Panel","props","join","header","children","footer","Accordian","summary","KeyMap","Enter","Backspace","ArrowLeft","ArrowUp","ArrowRight","ArrowDown","Home","End","PageUp","PageDown","Insert","Delete","Escape","F1","F2","F3","F4","F5","F6","F7","F8","F9","F10","F11","F12","Keyboard","keyboard","update","showPicker","setShowPicker","getKey","bits","setBits","currentKey","setKey","key","_jsxs","_jsx","RegisterComponent","name","ref","focus","type","onKeyDown","event","preventDefault","keypress","mapping","code","charCodeAt","keyPressToHackCharacter","onKeyUp","clearKey","onClick","Mode","mode","setMode","useStateInitializer","setValue","view","cursor","width","doSelect","select","doChange","edit","display","position","zIndex","left","marginTop","onBlur","onKeyPress","defaultValue","render","doScroll","scrollTop","state","get","totalHeight","toleranceHeight","bufferedItems","settings","itemHeight","minIndex","maxIndex","index","Math","floor","data","offset","limit","max","min","getData","topPaddingHeight","bottomPaddingHeight","viewportRef","MAX_SAFE_INTEGER","startIndex","count","tolerance","fillVirtualScrollSettings","startState","adapter","itemsAbove","viewportHeight","initialState","reducer","useReducer","dispatchScroll","row","initialScroll","div","rows","map","d","height","rowKey","overflowY","overflowAnchor","onScroll","MemoryBlock","memory","jmp","editable","format","dec","size","i","MemoryCell","VirtualScroll","rounded","background","hex","flex","textAlign","InlineEdit","newValue","Memory","fmt","setFormat","setJmp","goto","setGoto","jumpTo","isNaN","parseInt","isFinite","fileUploadRef","doLoad","click","setStatus","BaseContext","upload","files","file","source","loader","endsWith","loadHack","loadAsm","loadBlob","bytes","loadBytes","doUpdate","useClockReset","placeholder","FORMATS","option","bin","asm","doFormat","WHITE","set","x","y","pixel","color","Screen","canvas","draw","ctx","getContext","image","assertExists","getImageData","col","putImageData","drawImage","ctxRef","useClockFrame","clearRect","backgroundColor","maxWidth","boxSizing","marginInline","margin","borderTop","borderLeft","borderBottom","borderRight","frameFinished","subscription","Clock","frame$","subscribe","unsubscribe","reset","reset$","displayClock","Clockface","clockface","setClockface","$","useClockface","whiteSpace","useImmerReducer","reducers","command","produce","draft","action","payload","init","setState","Runbar","runner","timer","dispatch","running","speed","steps","finishFrame","bind","setSteps","setSpeed","actions","frame","stop","makeTimerStore","dispatcher","useTimer","label","clock","Timer","now","Date","delta","done","timingLabel","console","time","tick","timeEnd","requestAnimationFrame","this","toggle"],"sourceRoot":""}